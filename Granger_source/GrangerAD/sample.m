data1 = [ 2.22974507 1.77638876 1.36251694 0.63430955 1.56276414 1.45049636 1.49355146 1.33083748 1.45067782 1.68305934 1.54421536 1.74168241  1.37840367 1.40733197 1.50468499 1.58443507 1.4767025 1.66373543  1.46783808 1.32792633 1.65257529 1.68632441 1.9030402 1.96999589  1.84691613 2.07700135 2.23981053 1.66073599 2.14179324 2.03673212  2.14653166 2.14159997 2.13133767 0.97888903 0.4334023 0.65564258  0.64874987 1.24975657 0.50703108 0.77332397 1.10924767 0.81356824  0.80387861 0.53311585 0.73540776 0.79021073 1.23688976 1.23688976  1.23688976 1.23688976 1.23688976 1.23688976 1.23688976 1.23688976  1.23688976 1.23688976 1.23688976 1.23688976 1.23688976 1.23688976  1.23688976 1.23688976 1.23688976 1.23688976 1.23688976 1.23688976  1.23688976 1.23688976 1.23688976 1.23688976 1.23688976 1.23688976  1.23688976 1.23688976 1.23688976 1.23688976 1.23688976 1.23688976  1.23688976 1.23688976 1.23688976 1.23688976 0.0  ] ;
data2 = [ 0.9689441 0.91743119 0.94186047 0.96  0.87254902 0.91479821  0.9253112 0.84210526 0.84100418 0.89361702 0.8028169 0.89380531  0.84507042 0.78195489 0.84158416 0.9047619 0.87951807 0.8852459  0.96296296 0.86458333 0.91346154 0.87096774 0.79439252 0.86111111  0.81092437 0.80536913 0.78409091 0.87387387 0.82795699 0.81818182  0.77966102 0.72277228 0.87804878 0.93192869 0.95528086 0.94703872  0.94246176 0.88693957 0.94637332 0.94028662 0.94227273 0.93467543  0.93321678 0.9125 0.92724458 0.8986421 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 1.0  ] ;
data3 = [ 161 109 86 25 102 223 241 228 239 188 142 113 142 133 101  84 83 244 945 192 208 186 107 144 238 149 88 111 93 132  118 101 123 617 5501 1756 1373 513 2909 1256 2200 2434 2860 240 1938  2062 158 158 158 158 158 158 158 158 158 158 158 158 158 158  158 158 158 158 158 158 158 158 158 158 158 158 158 158 158  158 158 158 158 158 158 158 1];
data4 = [ 0.7826087 0.70642202 0.72093023 0.76  0.60784314 0.78026906  0.74688797 0.6622807 0.69456067 0.70744681 0.57746479 0.76106195  0.63380282 0.63909774 0.67326733 0.70238095 0.71084337 0.75819672  0.8952381 0.74479167 0.78846154 0.77956989 0.60747664 0.70833333  0.67226891 0.60402685 0.65909091 0.76576577 0.66666667 0.6969697  0.6440678 0.62376238 0.71544715 0.87358185 0.90201781 0.88952164  0.88710852 0.82066277 0.90959092 0.9044586 0.90363636 0.90591619  0.90524476 0.90416667 0.91331269 0.88894277 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 0.87974684 0.87974684  0.87974684 0.87974684 0.87974684 0.87974684 1.0  ];   
data5 = [ 0.98905899 0.92661201 0.94296344 0.96  0.91810011 0.96071851  0.95574006 0.91146039 0.86956916 0.90964569 0.85379189 0.907415  0.87706689 0.83458754 0.88118902 0.91666667 0.92771084 0.9057377  0.97013506 0.89237044 0.93750876 0.89587494 0.80467133 0.8824706  0.84386129 0.86577245 0.81565007 0.883858 0.83973056 0.83333333  0.82013881 0.7799657 0.90243902 0.93854357 0.95677982 0.94959703  0.94465228 0.8997202 0.9474999 0.94272511 0.94375231 0.93712477  0.93627149 0.91265851 0.93039989 0.90218525 0.87977814 0.87977814  0.87977814 0.87977814 0.87977814 0.87977814 0.87977814 0.87977814  0.87977814 0.87977814 0.87977814 0.87977814 0.87977814 0.87977814  0.87977814 0.87977814 0.87977814 0.87977814 0.87977814 0.87977814  0.87977814 0.87977814 0.87977814 0.87977814 0.87977814 0.87977814  0.87977814 0.87977814 0.87977814 0.87977814 0.87977814 0.87977814  0.87977814 0.87977814 0.87977814 0.87977814 1.0  ];
data6 =[ 0.71912204 0.87731491 1.04376258 1.40563906 0.88967452 0.54856211 0.53175152 0.55124426 0.55343821 0.62240886 0.74833934 0.85191151 0.7632238 0.79266917 0.94361834 1.04220472 1.02522303 0.52746524 0.19799156 0.6144071 0.58449179 0.63295556 0.93026894 0.7709049 0.53611494 0.74182611 0.96449673 0.8470438 0.98779719 0.81249067 0.84709773 0.87185117 0.82816918 0.27686884 0.04748681 0.12145272 0.1041873 0.31396252 0.07103816 0.15854998 0.10125327 0.09326488 0.07942194 0.03908175 0.11218925 0.10670825 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.2035722 0.0];
data = zeros(6,83);
data(1,1:83) = data1;
data(2,1:83) = data2;
data(3,1:83) = data3;
data(4,1:83) = data4;
data(5,1:83) = data5;
data(6,1:83) = data6;

[granger_ref_coeffs_N, granger_test_coeffs_N, granger_anomaly_scores_N, ...
		granger_threshs_N] = ...
		granger_anomaly_detection(data, 1, 1:30, 32:36, 5, ...
		0.95, 40, 40, 10, 1);
    
for j=1:length(granger_ref_coeffs_N)
       disp(granger_ref_coeffs_N{j})
end

scores = zeros(6,83);
x = 1:83;
%     plotyy(1:79, data(1:79), 'b', 1:80, scores(i,1:79), 'r');
%     disp(size(data))
% disp(size(granger_anomaly_scores_N))

for i = 1:6
%     disp(size(scores(i,32:37)))
%     disp(size(granger_anomaly_scores_N(i,:)));
    scores(i,32:37) = granger_anomaly_scores_N(i,:);    
    cur_data = data(i,:);
%     disp(size(cur_data));
    
    subplot(6,1,i);
%     disp(size(cur_data));
    plotyy(x, cur_data, x, scores(i,:));
end